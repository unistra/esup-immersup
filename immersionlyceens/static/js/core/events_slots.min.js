function init_datatable(){dt=$("#slots_list").DataTable({ajax:{url:"/api/slots",data:function(t){return t.events=!0,$("#id_establishment").val()&&(t.establishment_id=$("#id_establishment").val()),$("#id_structure").val()&&(t.structure_id=$("#id_structure").val()),$("#id_highschool").val()&&(t.highschool_id=$("#id_highschool").val()),t.past=$("#filter_past_slots").is(":checked"),t},dataSrc:function(t){return void 0!==t.data&&0!==t.data.length?t.data:[]}},order:[[4,"asc"],[1,"asc"],[2,"asc"],[3,"asc"]],processing:!1,serverSide:!1,responsive:!1,info:!1,search:!0,searchCols:[null,null,{search:event_type_filter},null,null,null,null,null,null,null],paging:!0,ordering:!0,language:{url:language_file},columns:[{data:"published",render:function(t,e,l){return t?yes_text:no_text}},{data:"structure",render:function(t,e,l){if(l.establishment){let t=l.establishment.short_label;return l.structure&&(t+=" - "+l.structure.label),t}if(l.highschool)return l.highschool.label}},{data:"event.type"},{data:"event.label",render:function(t,e,l){let a=t;return l.can_update_event_slot&&(a='<a href="/core/off_offer_event/'+l.event.id+'">'+t+"</a>"),a+='<span style="padding-left:5px" data-toggle="tooltip" title="'+l.event.description+'"><i class="fa fas fa-info-circle fa-2x centered-icon"></i></span>',a}},{data:"datetime",render:function(t,e,l){return"display"===e||"filter"===e?"<span>"+l.date+"</span><br><span>"+l.time.start+" - "+l.time.end+"</span>":t}},{data:"location",render:function(t,e,l){let a="";return l.face_to_face?(t.campus&&(a+=t.campus),t.building&&(a+=" - "+t.building),l.room&&(""!==a&&(a+="<br>"),a+=l.room),a):remote_event_text}},{data:"speakers",render:function(t){let e="";return $.each(t,function(t,l){e+='<a href="mailto:'+l+'">'+t+"</a><br>"}),e}},{data:"n_register",render:function(t,e,l){let a=t,n=l.n_places;return element="<span>"+a+"/"+n+'</span><div class="progress">    <div       class="progress-bar"       role="progressbar"       aria-valuenow="'+a+'"       aria-valuemin="0"       aria-valuemax="'+n+'"       style="width: '+Math.round(a/n*100)+'%"></div></div>',element}},{data:"additional_information",render:function(t){return t?'<span data-toggle="tooltip" title="'+t+'"><i class="fa fas fa-info-circle fa-2x centered-icon"></i></span>':""}},{data:"restrictions",render:function(t){let e="";return!0===t.establishment_restrictions&&(e+=establishments_txt+" :\n",t.allowed_establishments.forEach(t=>{e+="- "+t+"\n"}),t.allowed_highschools.forEach(t=>{e+="- "+t+"\n"})),!0===t.levels_restrictions&&(e&&(e+="\n"),e+=levels_txt+" :\n",t.allowed_highschool_levels.forEach(t=>{e+="- "+t+"\n"}),t.allowed_post_bachelor_levels.forEach(t=>{e+="- "+t+"\n"}),t.allowed_student_levels.forEach(t=>{e+="- "+t+"\n"})),e?'<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-info-circle fa-2x centered-icon"></i></span>':""}},{data:"id",render:function(t,e,l){if(l.can_update_event_slot){let e='    <a href="/core/off_offer_event_slot/'+t+'/1" class="btn btn-light btn-sm mr-1"     title="'+duplicate_text+'"><i class="fa far fa-copy fa-2x centered-icon"></i></a>';return!1===l.is_past&&(e+='<a href="/core/off_offer_event_slot/'+t+'" class="btn btn-light btn-sm mr-1" title="'+modify_text+'"><i class="fa fas fa-pencil fa-2x centered-icon"></i></a>\n'),0===l.n_register&&!1===l.is_past&&(e+='<button class="btn btn-light btn-sm mr-1" onclick="deleteDialog.data(\'slot_id\', '+t+").dialog('open')\" title=\""+delete_text+'"><i class="fa fas fa-trash fa-2x centered-icon"></i></button>\n'),1===l.attendances_value?e+='<button class="btn btn-light btn-sm mr-1" name="edit" onclick="open_modal('+t+","+l.attendances_value+","+l.n_places+","+l.is_past+')" title="'+attendances_text+"\"><i class='fa fas fa-edit fa-2x centered-icon'></i></button>":-1!==l.attendances_value&&(e+='<button class="btn btn-light btn-sm mr-1" name="view" onclick="open_modal('+t+","+l.attendances_value+","+l.n_places+","+l.is_past+')" title="'+registered_text+"\"><i class='fa fas fa-eye fa-2x centered-icon'></i></button>"),e+="</div>",e}return""}}],columnDefs:[{defaultContent:"-",targets:"_all"},{orderable:!1,targets:[9]}]}),$("#filters_reset_all").click(function(){yadcf.exResetAllFilters(dt)}),$("#filter_past_slots").click(function(){dt.ajax.reload()}),yadcf.init(dt,[{column_number:0,filter_default_label:"",filter_container_id:"published_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:1,filter_default_label:"",filter_match_mode:"exact",filter_container_id:"managed_by_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:2,filter_default_label:"",style_class:"form-control form-control-sm",filter_container_id:"event_type_filter",filter_reset_button_text:!1},{column_number:3,filter_type:"text",filter_default_label:"",style_class:"form-control form-control-sm",filter_container_id:"label_filter",filter_reset_button_text:!1},{column_number:4,filter_type:"text",filter_default_label:"",filter_container_id:"date_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:5,filter_type:"text",filter_default_label:"",filter_container_id:"location_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:6,filter_type:"text",filter_default_label:"",filter_container_id:"speakers_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:7,filter_type:"text",filter_default_label:"",filter_container_id:"registration_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1}])}