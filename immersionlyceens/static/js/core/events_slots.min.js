function init_datatable(){if(dt=$("#slots_list").DataTable({ajax:{url:"/api/slots",data:function(e){return e.events=!0,$("#id_establishment").val()&&(e.establishment_id=$("#id_establishment").val()),$("#id_structure").val()&&(e.structure_id=$("#id_structure").val()),$("#id_highschool").val()&&(e.highschool_id=$("#id_highschool").val()),e.past=$("#filter_past_slots").is(":checked"),e},dataSrc:function(e){return void 0!==e.data&&0!==e.data.length?e.data:[]}},order:[[4,"asc"],[1,"asc"],[2,"asc"],[3,"asc"]],processing:!1,serverSide:!1,responsive:!1,info:!1,search:!0,searchCols:[null,{search:managed_by_filter},{search:event_type_filter},{search:event_label_filter.normalize("NFD").replace(/\p{Diacritic}/gu,"")},null,null,null,null,null,null],paging:!0,ordering:!0,language:{url:language_file},columns:[{data:"published",render:function(e,t,a){return e?yes_text:no_text}},{data:"managed_by",render:function(e,t,a){if(a.establishment){let e=a.establishment.code;return a.structure&&(e+=" - "+a.structure.code),e}if(a.highschool)return a.highschool.city+" - "+a.highschool.label}},{data:"event.type"},{data:"event.label",render:function(e,t,a){let l=e;return a.can_update_event_slot&&(l='<a href="/core/off_offer_event/'+a.event.id+'">'+e+"</a>"),l+='<span style="padding-left:5px" data-toggle="tooltip" title="'+a.event.description+'"><i class="fa fas fa-info-circle fa-2x centered-icon"></i></span>',"filter"===t?l.normalize("NFD").replace(/\p{Diacritic}/gu,""):l}},{data:"datetime",render:function(e,t,a){return"display"===t||"filter"===t?"<span>"+a.date+"</span><br><span>"+a.time.start+" - "+a.time.end+"</span>":e}},{data:"location",render:function(e,t,a){let l="";return a.face_to_face?(e.campus&&(l+=e.campus),e.building&&(l+=" - "+e.building),a.room&&(""!==l&&(l+="<br>"),l+=a.room)):l=remote_event_text,"filter"===t?l.normalize("NFD").replace(/\p{Diacritic}/gu,""):l}},{data:"speakers",render:function(e,t,a){let l="";return $.each(e,function(e,t){l+='<a href="mailto:'+t+'">'+e+"</a><br>"}),"filter"===t?l.normalize("NFD").replace(/\p{Diacritic}/gu,""):l}},{data:"n_register",render:function(e,t,a){let l=e,n=a.n_places;return element="<span>"+l+"/"+n+'</span><div class="progress">    <div       class="progress-bar"       role="progressbar"       aria-valuenow="'+l+'"       aria-valuemin="0"       aria-valuemax="'+n+'"       style="width: '+Math.round(l/n*100)+'%"></div></div>',element}},{data:"additional_information",render:function(e){return e?'<span data-toggle="tooltip" title="'+e+'"><i class="fa fas fa-info-circle fa-2x centered-icon"></i></span>':""}},{data:"restrictions",render:function(e){let t="";return!0===e.establishment_restrictions&&(t+=establishments_txt+" :\n",e.allowed_establishments.forEach(e=>{t+="- "+e+"\n"}),e.allowed_highschools.forEach(e=>{t+="- "+e+"\n"})),!0===e.levels_restrictions&&(t&&(t+="\n"),t+=levels_txt+" :\n",e.allowed_highschool_levels.forEach(e=>{t+="- "+e+"\n"}),e.allowed_post_bachelor_levels.forEach(e=>{t+="- "+e+"\n"}),e.allowed_student_levels.forEach(e=>{t+="- "+e+"\n"})),!0===e.bachelors_restrictions&&(t&&(t+="\n"),t+=bachelors_txt+" :\n",e.allowed_bachelor_types.forEach(e=>{t+="- "+e+"\n"}),e.allowed_bachelor_mentions.length>0&&(t+=allowed_mentions_txt+" :\n",e.allowed_bachelor_mentions.forEach(e=>{t+="- "+e+"\n"})),e.allowed_bachelor_teachings.length>0&&(t+=allowed_teachings_txt+" :\n",e.allowed_bachelor_teachings.forEach(e=>{t+="- "+e+"\n"}))),t?'<span style="max-width: none;white-space: nowrap;" data-toggle="tooltip" title="'+t+'"><i class="fa fas fa-info-circle fa-2x centered-icon"></i></span>':""}},{data:"id",render:function(e,t,a){let l="";return a.can_update_event_slot&&(l+='    <a href="/core/off_offer_event_slot/'+e+'/1" class="btn btn-light btn-sm mr-1"     title="'+duplicate_text+'"><i class="fa far fa-copy fa-2x centered-icon"></i></a>',!1===a.is_past&&(l+='<a href="/core/off_offer_event_slot/'+e+'" class="btn btn-light btn-sm mr-1" title="'+modify_text+'"><i class="fa fas fa-pencil fa-2x centered-icon"></i></a>\n'),0===a.n_register&&!1===a.is_past&&(l+='<button class="btn btn-light btn-sm mr-1" onclick="deleteDialog.data(\'slot_id\', '+e+").dialog('open')\" title=\""+delete_text+'"><i class="fa fas fa-trash fa-2x centered-icon"></i></button>\n')),a.can_update_attendances&&(1===a.attendances_value?l+='<button class="btn btn-light btn-sm mr-1" name="edit" onclick="open_modal('+e+","+a.attendances_value+","+a.n_places+","+a.is_past+","+a.can_update_registrations+","+a.face_to_face+')" title="'+attendances_text+"\"><i class='fa fas fa-edit fa-2x centered-icon'></i></button>":-1!==a.attendances_value&&(l+='<button class="btn btn-light btn-sm mr-1" name="view" onclick="open_modal('+e+","+a.attendances_value+","+a.n_places+","+a.is_past+","+a.can_update_registrations+')" title="'+registered_text+"\"><i class='fa fas fa-eye fa-2x centered-icon'></i></button>")),l+="</div>",l}}],columnDefs:[{defaultContent:"-",targets:"_all"},{orderable:!1,targets:[9]}],initComplete:function(){var e=this.api(),t=[3,5,6],a={3:event_label_filter};t.forEach(function(t){var l=e.column(t),n=l.header().id,i=$(`#${n}`),r=`${n}_input`,o=$(i).text();$(i).html(o+`<div><input id="${r}" class="form-control form-control-sm" type="text" style="padding: 3px 4px 3px 4px"/></div>`),$(`#${r}`).click(function(e){e.stopPropagation()}),t in a&&$(`#${r}`).val(a[t]),$(`#${r}`).off("keyup change").on("keyup change",function(a){a.stopPropagation();var l=this.selectionStart;e.column(t).search(""!==this.value?this.value.normalize("NFD").replace(/\p{Diacritic}/gu,""):"",""!==this.value,""===this.value).draw(),$(this).focus()[0].setSelectionRange(l,l)})})}}),$("#filters_reset_all").click(function(){yadcf.exResetAllFilters(dt);let e=[3,5,6];e.forEach(function(e){let t=dt.column(e),a=t.header().id,l=`${a}_input`;$(`#${l}`).val("")}),dt.columns().search("").draw()}),$("#filter_past_slots").click(function(){dt.ajax.reload()}),yadcf.init(dt,[{column_number:0,filter_default_label:"",filter_container_id:"published_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:1,filter_default_label:"",filter_match_mode:"exact",filter_container_id:"managed_by_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:2,filter_default_label:"",filter_match_mode:"exact",style_class:"form-control form-control-sm",filter_container_id:"event_type_filter",filter_reset_button_text:!1},{column_number:4,filter_type:"text",filter_default_label:"",filter_container_id:"date_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:7,filter_type:"text",filter_default_label:"",filter_container_id:"registration_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1}]),managed_by_filter||event_type_filter){let e=Array();managed_by_filter&&e.push([1,[managed_by_filter]]),event_type_filter&&e.push([2,[event_type_filter]]),yadcf.exFilterColumn(dt,e)}}