function init_datatable(){if(show_duplicate_btn=!("boolean"==typeof show_duplicate_btn&&!show_duplicate_btn)||show_duplicate_btn,show_delete_btn=!("boolean"==typeof show_delete_btn&&!show_delete_btn)||show_delete_btn,show_modify_btn=!("boolean"==typeof show_modify_btn&&!show_modify_btn)||show_modify_btn,cohorts_only=!("boolean"!=typeof cohorts_only||!cohorts_only)&&cohorts_only,current_slots_only=!("boolean"!=typeof current_slots_only||!current_slots_only)&&current_slots_only,cohorts_only){dt_columns=[{data:"id",render:function(t,e,a){let n="",r=0;return a.can_update_event_slot&&(n+=`<a href="/core/off_offer_event_slot/${t}/1" class="btn btn-light btn-sm mr-1" `+`title="${duplicate_text}"><i class="fa far fa-copy fa-2x centered-icon"></i></a>`,!1===a.is_past&&(n+=`<a href="/core/off_offer_event_slot/${t}" class="btn btn-light btn-sm mr-1" title="${modify_text}"><i class="fa fas fa-pencil fa-2x centered-icon"></i></a>\n`),0===a.n_register&&0===a.n_group_register&&!1===a.is_past&&(n+=`<button class="btn btn-light btn-sm mr-1" onclick="deleteDialog.data('slot_id', ${t}).dialog('open')" title="${delete_text}"><i class="fa fas fa-trash fa-2x centered-icon"></i></button>\n`)),a.can_update_attendances&&(!0===a.is_past&&(a.n_register>0||a.n_group_register>0)?(r=1,n+=`<button class="btn btn-light btn-sm mr-1" name="edit" onclick="open_modal(${t}, ${r}, ${a.n_places}, ${a.allow_individual_registrations}, ${a.allow_group_registrations}, ${a.group_mode}, ${a.n_group_places}, ${a.is_past}, ${a.can_update_registrations}, ${a.place})" title="${attendances_text}">`+"<i class='fa fas fa-edit fa-2x centered-icon'></i></button>"):(a.attendances_value===attendance_not_yet||a.attendances_value===attendance_nothing_to_enter||a.n_register>0||a.n_group_register>0)&&(n+=`<button class="btn btn-light btn-sm mr-1" name="view" onclick="open_modal(${t}, ${r}, ${a.n_places}, ${a.allow_individual_registrations}, ${a.allow_group_registrations}, ${a.group_mode}, ${a.n_group_places}, ${a.is_past}, ${a.can_update_registrations}, ${a.place})" title="${registered_text}">`+"<i class='fa fas fa-eye fa-2x centered-icon'></i></button>")),(a.can_update_registrations||a.public_group)&&!0===cohorts_only&&(n+=`<button class="btn btn-light btn-sm mr-1" name="view" onclick="open_modal(${t}, ${r}, ${a.n_places}, ${a.allow_individual_registrations}, ${a.allow_group_registrations}, ${a.group_mode}, ${a.n_group_places}, ${a.is_past}, ${a.can_update_registrations}, ${a.place})" title="${registered_text}">`+"<i class='fa fas fa-eye fa-2x centered-icon'></i></button>"),!0===cohorts_only&&(n+=`<span data-toggle="tooltip" data-html="true" data-contrainer="body" title="${registration_date_limit_txt} : <br>${formatDate(a.registration_limit_date)}">`+'<i class="fa fas fa-calendar pr-2"></i></span>'),n}},{data:"establishment_code",render:function(t,e,a){let n="";if(t)return n=t,n+=is_set(a.structure_code)?` - ${a.structure_code}`:"",n;if(a.highschool_label){let t=is_set(a.highschool_city)?a.highschool_city:no_city_txt;return`${t} - ${a.highschool_label}`}}},{data:"event_type_label"},{data:"event_id",render:function(t,e,a){let n=is_set(a.event_label)?a.event_label:"";return"filter"===e?n.normalize("NFD").replace(/\p{Diacritic}/gu,""):(a.can_update_event_slot&&(n=`<a href="/core/off_offer_event/${t}">${a.event_label}</a>`),n+=`<span style="padding-left:5px" data-toggle="tooltip" title="${a.event_description}"><i class="fa fas fa-info-circle fa-2x centered-icon"></i></span>`,n)}},{data:"date",render:function(t,e,a){return display_slot_date(t,e,a)}},{data:"campus_label",render:function(t,e,a){let n="",r=t,l=a.building_label,i=0,o=1,_=2;return"filter"===e?(a.place===i?n=`${r} ${l} ${a.room}`:a.place===o?n=remote_event_text:a.place===_&&(n=a.room),n.normalize("NFD").replace(/\p{Diacritic}/gu,"")):a.place===i?(n="<span>",n+=is_set(r)?`${r} </span><br><span>`:"",n+=is_set(l)?`${l} </span><br><span>`:"",`${n} ${a.room}</span>`):a.place===o?`<a href="${a.url}" target="_blank">${remote_event_text}</a>`:`<span>${a.room}</span>`}},{data:"speaker_list",render:function(t,e,a){return display_slot_speakers(t,e,a)}},{data:"n_register",render:function(t,e,a){return display_n_register(t,e,a,!0)}},{data:"additional_information",render:function(t){return display_additional_information(t)}},{data:"",render:function(t,e,a){return display_slot_restrictions(t,e,a)}}];var t=[3,5,6],e={3:event_label_filter},a=(t=[3,5,6],[{column_number:1,filter_default_label:"",filter_match_mode:"exact",filter_container_id:"managed_by_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:2,filter_default_label:"",filter_match_mode:"exact",style_class:"form-control form-control-sm",filter_container_id:"event_type_filter",filter_reset_button_text:!1},{column_number:4,filter_type:"text",filter_default_label:"",filter_container_id:"date_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:7,filter_type:"text",filter_default_label:"",filter_container_id:"registration_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1}])}else{dt_columns=[{data:"id",render:function(t,e,a){let n="",r=0;return a.can_update_event_slot&&(n+=`<a href="/core/off_offer_event_slot/${t}/1" class="btn btn-light btn-sm mr-1" `+`title="${duplicate_text}"><i class="fa far fa-copy fa-2x centered-icon"></i></a>`,!1===a.is_past&&(n+=`<a href="/core/off_offer_event_slot/${t}" class="btn btn-light btn-sm mr-1" title="${modify_text}"><i class="fa fas fa-pencil fa-2x centered-icon"></i></a>\n`),0===a.n_register&&0===a.n_group_register&&!1===a.is_past&&(n+=`<button class="btn btn-light btn-sm mr-1" onclick="deleteDialog.data('slot_id', ${t}).dialog('open')" title="${delete_text}"><i class="fa fas fa-trash fa-2x centered-icon"></i></button>\n`)),a.can_update_attendances&&(!0===a.is_past&&(a.n_register>0||a.n_group_register>0)?(r=1,n+=`<button class="btn btn-light btn-sm mr-1" name="edit" onclick="open_modal(${t}, ${r}, ${a.n_places}, ${a.allow_individual_registrations}, ${a.allow_group_registrations}, ${a.group_mode}, ${a.n_group_places}, ${a.is_past}, ${a.can_update_registrations}, ${a.place})" title="${attendances_text}">`+"<i class='fa fas fa-edit fa-2x centered-icon'></i></button>"):(a.attendances_value===attendance_not_yet||a.attendances_value===attendance_nothing_to_enter||a.n_register>0||a.n_group_register>0)&&(n+=`<button class="btn btn-light btn-sm mr-1" name="view" onclick="open_modal(${t}, ${r}, ${a.n_places}, ${a.allow_individual_registrations}, ${a.allow_group_registrations}, ${a.group_mode}, ${a.n_group_places}, ${a.is_past}, ${a.can_update_registrations}, ${a.place})" title="${registered_text}">`+"<i class='fa fas fa-eye fa-2x centered-icon'></i></button>")),(a.can_update_registrations||a.public_group)&&!0===cohorts_only&&(n+=`<button class="btn btn-light btn-sm mr-1" name="view" onclick="open_modal(${t}, ${r}, ${a.n_places}, ${a.allow_individual_registrations}, ${a.allow_group_registrations}, ${a.group_mode}, ${a.n_group_places}, ${a.is_past}, ${a.can_update_registrations}, ${a.place})" title="${registered_text}">`+"<i class='fa fas fa-eye fa-2x centered-icon'></i></button>"),!0===cohorts_only&&(n+=`<span data-toggle="tooltip" data-html="true" data-contrainer="body" title="${registration_date_limit_txt} : <br>${formatDate(a.registration_limit_date)}">`+'<i class="fa fas fa-calendar pr-2"></i></span>'),n}},{data:"published",render:function(t,e,a){return t?yes_text:no_text}},{data:"establishment_code",render:function(t,e,a){let n="";if(t)return n=t,n+=is_set(a.structure_code)?` - ${a.structure_code}`:"",n;if(a.highschool_label){let t=is_set(a.highschool_city)?a.highschool_city:no_city_txt;return`${t} - ${a.highschool_label}`}}},{data:"event_type_label"},{data:"event_id",render:function(t,e,a){let n=is_set(a.event_label)?a.event_label:"";return"filter"===e?n.normalize("NFD").replace(/\p{Diacritic}/gu,""):(a.can_update_event_slot&&(n=`<a href="/core/off_offer_event/${t}">${a.event_label}</a>`),n+=`<span style="padding-left:5px" data-toggle="tooltip" title="${a.event_description}"><i class="fa fas fa-info-circle fa-2x centered-icon"></i></span>`,n)}},{data:"date",render:function(t,e,a){return display_slot_date(t,e,a)}},{data:"campus_label",render:function(t,e,a){let n="",r=t,l=a.building_label,i=0,o=1,_=2;return"filter"===e?(a.place===i?n=`${r} ${l} ${a.room}`:a.place===o?n=remote_event_text:a.place===_&&(n=a.room),n.normalize("NFD").replace(/\p{Diacritic}/gu,"")):a.place===i?(n="<span>",n+=is_set(r)?`${r} </span><br><span>`:"",n+=is_set(l)?`${l} </span><br><span>`:"",`${n} ${a.room}</span>`):a.place===o?`<a href="${a.url}" target="_blank">${remote_event_text}</a>`:`<span>${a.room}</span>`}},{data:"speaker_list",render:function(t,e,a){return display_slot_speakers(t,e,a)}},{data:"n_register",render:function(t,e,a){return display_n_register(t,e,a)}},{data:"additional_information",render:function(t){return display_additional_information(t)}},{data:"",render:function(t,e,a){return display_slot_restrictions(t,e,a)}},{data:"allow_group_registrations",render:function(t,e,a){return"display"===e?display_group_informations(a):"filter"===e||"sort"===e?set_group_filter(a,e):t}}];t=[4,6,7],e={4:event_label_filter},t=[4,6,7],a=[{column_number:1,filter_default_label:"",filter_container_id:"published_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:2,filter_default_label:"",filter_match_mode:"exact",filter_container_id:"managed_by_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:3,filter_default_label:"",filter_match_mode:"exact",style_class:"form-control form-control-sm",filter_container_id:"event_type_filter",filter_reset_button_text:!1},{column_number:5,filter_type:"text",filter_default_label:"",filter_container_id:"date_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:8,filter_type:"text",filter_default_label:"",filter_container_id:"registration_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:11,filter_default_label:"",filter_match_mode:"exact",filter_container_id:"groups_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1}]}if(dt=$("#slots_list").DataTable({ajax:{url:"/core/utils/slots",data:function(t){return t.events=!0,(is_set(current_establishment_id)||$("#id_establishment").val())&&(t.establishment_id=current_establishment_id||$("#id_establishment").val()),(is_set(current_structure_id)||$("#id_structure").val())&&(t.structure_id=current_structure_id||$("#id_structure").val()),(is_set(current_highschool_id)||$("#id_highschool").val())&&(t.highschool_id=current_highschool_id||$("#id_highschool").val()),is_set(cohorts_only)&&(t.cohorts_only=cohorts_only),is_set(current_slots_only)&&(t.current_slots_only=current_slots_only),t.past=$("#filter_past_slots").is(":checked"),t},dataSrc:function(t){return void 0!==t.data&&0!==t.data.length?t.data:[]}},order:[[5,"asc"],[2,"asc"],[3,"asc"],[4,"asc"]],processing:!1,serverSide:!1,responsive:!1,info:!1,search:!0,searchCols:[null,null,{search:managed_by_filter},{search:event_type_filter},{search:event_label_filter.normalize("NFD").replace(/\p{Diacritic}/gu,"")},null,null,null,null,null],paging:!0,ordering:!0,language:{url:language_file},columns:dt_columns,columnDefs:[{defaultContent:"-",targets:"_all"},{orderable:!1,targets:[0]}],initComplete:function(){var a=this.api();t.forEach(function(t){var n=a.column(t),r=n.header().id,l=$(`#${r}`),i=`${r}_input`,o=$(l).text();$(l).html(o+`<div><input id="${i}" class="form-control form-control-sm" type="text" style="padding: 3px 4px 3px 4px"/></div>`),$(`#${i}`).click(function(t){t.stopPropagation()}),t in e&&$(`#${i}`).val(e[t]),$(`#${i}`).off("keyup change").on("keyup change",function(e){e.stopPropagation();var n=this.selectionStart;a.column(t).search(""!==this.value?this.value.normalize("NFD").replace(/\p{Diacritic}/gu,""):"",""!==this.value,""===this.value).draw(),$(this).focus()[0].setSelectionRange(n,n)})})}}),$("#filters_reset_all").click(function(){yadcf.exResetAllFilters(dt),t.forEach(function(t){let e=dt.column(t),a=e.header().id,n=`${a}_input`;$(`#${n}`).val("")}),dt.columns().search("").draw()}),$("#filter_past_slots").click(function(){dt.ajax.reload()}),dt.on("draw",function(){$('[data-toggle="tooltip"]').tooltip()}),yadcf.init(dt,a),managed_by_filter||event_type_filter){let t=Array();managed_by_filter&&cohorts_only?t.push([1,[managed_by_filter]]):managed_by_filter&&t.push([2,[managed_by_filter]]),event_type_filter&&cohorts_only?t.push([2,[event_type_filter]]):event_type_filter&&t.push([3,[event_type_filter]]),yadcf.exFilterColumn(dt,t)}}