function init_datatable(){if(dt=$("#slots_list").DataTable({ajax:{url:"/core/utils/slots",data:function(t){return t.visits=!0,(is_set(current_establishment_id)||$("#id_establishment").val())&&(t.establishment_id=current_establishment_id||$("#id_establishment").val()),(is_set(current_structure_id)||$("#id_structure").val())&&(t.structure_id=current_structure_id||$("#id_structure").val()),t.past=$("#filter_past_slots").is(":checked"),t},dataSrc:function(t){return void 0!==t.data&&0!==t.data.length?t.data:[]}},order:[[5,"asc"],[2,"asc"],[3,"asc"],[4,"asc"]],processing:!1,serverSide:!1,responsive:!1,info:!1,search:!0,searchCols:[null,null,{search:highschool_filter},{search:managed_by_filter},{search:visit_purpose_filter.normalize("NFD").replace(/\p{Diacritic}/gu,"")},null,null,null,null,null],paging:!0,ordering:!0,language:{url:language_file},columns:[{data:"id",render:function(t,e,i){let a="";return i.can_update_visit_slot&&(a+=`<a href="/core/visit_slot/${t}/1" class="btn btn-light btn-sm mr-1" `+`title=${duplicate_text}"><i class="fa far fa-copy fa-2x centered-icon"></i></a>`,!1===i.is_past&&(a+=`<a href="/core/visit_slot/${t}" class="btn btn-light btn-sm mr-1" title="${modify_text}"><i class="fa fas fa-pencil fa-2x centered-icon"></i></a>\n`),0===i.n_register&&!1===i.is_past&&(a+=`<button class="btn btn-light btn-sm mr-1" onclick="deleteDialog.data('slot_id', ${t}).dialog('open')" title="${delete_text}"><i class="fa fas fa-trash fa-2x centered-icon"></i></button>\n`),1===i.attendances_value?a+=`<button class="btn btn-light btn-sm mr-1" name="edit" onclick="open_modal(${t}, ${i.attendances_value}, ${i.n_places}, ${i.is_past}, ${i.can_update_registrations}, ${i.face_to_face})" title="${attendances_text}">`+"<i class='fa fas fa-edit fa-2x centered-icon'></i></button>":-1!==i.attendances_value&&(a+=`<button class="btn btn-light btn-sm mr-1" name="view" onclick="open_modal(${t}, ${i.attendances_value}, ${i.n_places}, ${i.is_past}, ${i.can_update_registrations})" title="${registered_text}">`+"<i class='fa fas fa-eye fa-2x centered-icon'></i></button>")),a}},{data:"published",render:function(t,e,i){return t?yes_text:no_text}},{data:"highschool_label",render:function(t,e,i){return`${i.highschool_city} - ${t}`}},{data:"establishment_code",render:function(t,e,i){let a=t;return a+=is_set(i.structure_code)?` - ${i.structure_code}`:"",a}},{data:"visit_id",render:function(t,e,i){let a=is_set(i.visit_purpose)?i.visit_purpose:"";return"filter"===e?a.normalize("NFD").replace(/\p{Diacritic}/gu,""):(i.can_update_visit_slot&&(a=`<a href="/core/visit/${t}">${i.visit_purpose}</a>`),a)}},{data:"date",render:function(t,e,i){return display_slot_date(t,e,i)}},{data:"room",render:function(t,e,i){let a=i.face_to_face?i.room:remote_visit_text;return"filter"===e?a.normalize("NFD").replace(/\p{Diacritic}/gu,""):a}},{data:"speaker_list",render:function(t,e,i){return display_slot_speakers(t,e,i)}},{data:"n_register",render:function(t,e,i){return display_n_register(t,e,i)}},{data:"additional_information",render:function(t){return display_additional_information(t)}},{data:"",render:function(t,e,i){return display_slot_restrictions(t,e,i)}}],columnDefs:[{defaultContent:"-",targets:"_all"},{orderable:!1,targets:[10]}],initComplete:function(){var t=this.api(),e=[4,6,7],i={4:visit_purpose_filter};e.forEach(function(e){var a=t.column(e),r=a.header().id,l=$(`#${r}`),n=`${r}_input`,s=$(l).text();$(l).html(s+`<div><input id="${n}" class="form-control form-control-sm" type="text" style="padding: 3px 4px 3px 4px"/></div>`),$(`#${n}`).click(function(t){t.stopPropagation()}),e in i&&$(`#${n}`).val(i[e]),$(`#${n}`).off("keyup change").on("keyup change",function(i){i.stopPropagation(),$(this).attr("title",$(this).val());var a=this.selectionStart;t.column(e).search(""!==this.value?this.value.normalize("NFD").replace(/\p{Diacritic}/gu,""):"",""!==this.value,""===this.value).draw(),$(this).focus()[0].setSelectionRange(a,a)})})}}),$("#filters_reset_all").click(function(){yadcf.exResetAllFilters(dt);let t=[4,6,7];t.forEach(function(t){let e=dt.column(t),i=e.header().id,a=`${i}_input`;$(`#${a}`).val("")}),dt.columns().search("").draw()}),$("#filter_past_slots").click(function(){dt.ajax.reload()}),dt.on("draw",function(){$('[data-toggle="tooltip"]').tooltip()}),yadcf.init(dt,[{column_number:1,filter_default_label:"",filter_container_id:"published_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:2,filter_default_label:"",filter_match_mode:"exact",filter_container_id:"highschool_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:3,filter_default_label:"",filter_match_mode:"exact",style_class:"form-control form-control-sm",filter_container_id:"managed_by_filter",filter_reset_button_text:!1},{column_number:5,filter_type:"text",filter_default_label:"",filter_container_id:"date_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1},{column_number:8,filter_type:"text",filter_default_label:"",filter_container_id:"registration_filter",style_class:"form-control form-control-sm",filter_reset_button_text:!1}]),highschool_filter||managed_by_filter||visit_purpose_filter){let t=Array();highschool_filter&&t.push([2,[highschool_filter]]),managed_by_filter&&t.push([3,[managed_by_filter]]),visit_purpose_filter&&t.push([4,[visit_purpose_filter]]),yadcf.exFilterColumn(dt,t)}}