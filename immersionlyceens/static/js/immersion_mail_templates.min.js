function getCookie(e){var t=null;if(document.cookie&&""!=document.cookie)for(var n=document.cookie.split(";"),o=0;o<n.length;o++){var a=django.jQuery.trim(n[o]);if(a.substring(0,e.length+1)==e+"="){t=decodeURIComponent(a.substring(e.length+1));break}}return t}const load_preview=()=>{let e=document.getElementById("id_body").value,t=document.getElementById("template_preview_content");t.innerHTML=gettext("<p>Waiting for content</p>");let n="/api/mail_template/"+template_id+"/preview",o=new FormData(document.getElementById("preview_control_form"));o.append("body",e),fetch(n,{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken")},body:o}).then(e=>e.json()).then(e=>{null===e.data?t.innerHTML='<h3 class="errornote" style="background: transparent;">'+e.msg+"</h3>":t.innerHTML=e.data}).catch(e=>{t.innerHTML='<h3 class="errornote" style="background: transparent;">'+gettext("An unexpected error occur")+"</h3>"})};$(document).ready(function(){$("#id_body").before("<div><button type='button' id='toggle-modal' class=\"button default\" style=\"float: None; padding: 10px;\">"+gettext("View available variables")+"</button><button type='button' id='toggle-preview-modal' class=\"button default\" style=\"float: None; padding: 10px; margin-left: 20px;\">"+gettext("Preview")+"</button></div>"),$("#id_body").css("position","relative"),$("#id_body").css("top","20px"),$("#template_vars_dialog").dialog({autoOpen:!1,modal:!0,width:1e3}),$("#template_preview_dialog").dialog({autoOpen:!1,modal:!0,width:1e3}),$("#toggle-modal").click(function(){$("#template_vars_dialog").dialog("open")}),$("#toggle-preview-modal").click(()=>{$("#template_preview_dialog").dialog("open"),load_preview()});let e=()=>{load_preview()},t=document.getElementById("slot_type_input"),n=document.getElementById("user_group_input"),o=document.getElementById("local_user_input"),a=document.getElementById("face_to_face_input");t.addEventListener("change",e),n.addEventListener("change",e),o.addEventListener("change",e),a.addEventListener("change",e)});